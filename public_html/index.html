<!DOCTYPE html>
<html>
    <head>
        <title>test</title>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-responsive.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-responsive.min.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-fileupload.min.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-arrows.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <link rel="stylesheet" type="text/css" href="css/skin.css">        

        <script type="text/javascript" src="js/libs/zip.js"></script>
        <script type="text/javascript" src="js/libs/zip-ext.js"></script>
        <script type="text/javascript" src="js/libs/exif.js"></script>
        <script type="text/javascript" src="js/libs/binaryajax.js"></script>

        <script type="text/javascript" src="js/libs/jquery-1.9.0/jquery.min.js"></script>
        <script type="text/javascript" src="js/libs/jqueryui-1.10.0/jquery-ui.min.js"></script>
        <script type="text/javascript" src="js/libs/jquery.exif.js"></script>

        <script type="text/javascript" src="js/libs/bootstrap.js"></script>
        <script type="text/javascript" src="js/libs/bootstrap-fileupload.min.js"></script>
        <script type="text/javascript" src="js/libs/bootstrap-arrows.js"></script>

        <script type="text/javascript" src="js/libs/jquery.jcarousel.js"></script>
        <script type="text/javascript" src="js/libs/jquery.jcarousel.min.js"></script>

        <script type="text/javascript" src="js/PowerPointReader.js"></script>
        <script type="text/javascript" src="js/PowerPointImage.js"></script>
        <script type="text/javascript" src="js/PowerPoint.js"></script>
        <script type="text/javascript" src="js/SlideImageRel.js"></script>

        <script type="text/javascript" src="js/PowerPointViewer.js"></script>

        <script type="text/javascript" src="js/Change.js"></script>
        <script type="text/javascript" src="js/PowerPointWriter.js"></script>

        <script type="text/javascript" src="js/PowerPointRedactor.js"></script>

        <script type="text/javascript" src="js/FlickrReader.js"></script>
        <script type="text/javascript" src="js/FlickrImage.js"></script>
        <script type="text/javascript" src="js/FlickrResultsViewer.js"></script>

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    </head>
    <body>

        <script type="text/javascript">
            //check for the various File API support
            if (window.File && window.FileReader && window.FileList && window.Blob) {
                //all file APIs are supported
            } else {
                alert('The File APIs are not fully supported in this browser.');
            }
        </script>

        <div class="container-fluid">
            <div id="controlPanel" class="row-fluid">
                <div class="fileupload fileupload-new" data-provides="fileupload">
                    <span class="btn btn-file"><span class="fileupload-new">Select file</span><span class="fileupload-exists">Change</span><input id="files" type="file" /></span>
                    <span class="fileupload-preview"></span>
                    <a href="#" class="close fileupload-exists" data-dismiss="fileupload" style="float: none">Ã—</a>
                </div>

                <button id="redactBtn" type="submit" class="btn disabled">Redact...</button>
                <a id="download" href="#" class="btn disabled">Download...</a>
                <!--<input type="file" id="files" name="files[]" multiple/>
                <output id="list"></output>-->
            </div>
            <!--<div id="imageList" class="row-fluid">
            </div>-->

            <div id="imageOverview" class="row-fluid">
                
                <div id="imageWindow" class="span9">
                    
                    <span id="pptImage">
                        <span class="helper"></span>
                    </span>    
                    <!-- placeholder -->
                    <span id="placeholderOverview">
                        <span id="placeholderOld">
                        </span>
                        <span id="placeholderArrow">
                            <span class="arrow-primary-large" data-angle="90"></span>
                        </span>
                        <span id="placeholderNew">
                            <img src="img/placeholder.jpg"/>
                        </span>  
                        <button id="placeholderSave" class="btn btn-primary">Save</button>                    
                    </span>

                    <!-- Flickr Search -->
                    <span id="flickrSearch">

                    </span>  

                    <!-- Flickr Overview -->

                    <!-- cc Overview -->
                    <div id="ccOverview" class="row-fluid">
                        <div id="ccOld" class="span6">
                        </div>                        
                        <div id="ccText" class="span6">
                            
                            <h2>Choose a CC Licence:</h2>
                            <p>For more information see: <a href="http://creativecommons.org/" target="_blank">Creative Commons</a></p>
                            <select id="ccSelector">
                                <option>Attribution (CC BY)</option>
                                <option>Attribution-Sharelike (CC BY-SA)</option>
                                <option>Attribution-NoDerivs (CC BY-ND)</option>
                                <option>Attribution-NonCommercial (CC BY-NC)</option>
                                <option>Attribution-NonCommercial-ShareAlike (CC BY-NC-SA)</option>
                                <option>Attribution-NonCommercial-NoDerivs (CC BY-NC-ND)</option>
                            </select>
                        </div>  
                        <button id="ccSave" class="btn btn-primary">Save</button>                    
                    </div>

                </div>

                <!-- Image Info/Buttons Panel -->
                <div id="imagePanel" class="span3">
                    <div id="imageInfo">
                        <span class="imageField">
                            <span>
                                Slides:
                            </span>                         
                            <span>
                                <span id="imageSlides">

                                </span>
                            </span>
                        </span>
                        <span class="imageField">
                            <span>
                                Author:
                            </span>
                            <span id="imageAuthor">
                            </span>
                        </span>
                        <span class="imageField">
                            <span>
                                Licence:
                            </span>
                            <span id="imageLicence">
                            </span>
                        </span>
                        <span class="imageField">
                            <span>
                                Size:
                            </span>
                            <span id="imageSize">
                            </span>
                        </span>
                    </div>
                    <div id="buttons">
                        <button id="verifyBtn" class="btn btn-primary btn-block imageButtons disabled">Verify</button>                        
                        <button id="flickrBtn" class="btn btn-success btn-block imageButtons disabled">Flickr</button>
                        <button id="ccBtn" class="btn btn-warning btn-block imageButtons disabled">Creative Commons</button>
                        <button id="placeholderBtn" class="btn btn-danger btn-block imageButtons disabled">Placeholder</button>
                    </div>
                </div>                
            </div>
            <div class="row-fluid">
                <div id="imageCarousel" class="span12">
                    <ul id="mycarousel" class="jcarousel-skin-tango">
                    </ul>
                </div>
            </div>
        </div>


        <!-- Flickr Modal -->

        <div id="flickr-modal" class="modal hide fade">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>

                <form id="flickr" class="form-inline">
                    <input type="text" class="input-medium search-query" placeholder="Search" name="tags" id="tags">

                    <label class="multiple" for="sort">Sort:</label>
                    <select id="sort" name="sort" class="input-medium">
                        <option>Relevant</option>
                        <option>Recent</option>
                        <option>Interesting</option>
                    </select>
                    <label class="multiple" for="licence">Licence:</label>
                    <select id="licence" name="licence" class="input-medium">
                        <option>Attribution</option>
                        <option>NoDerivs</option>
                        <option>NonCommercial, NoDerivs</option>
                        <option>NonCommercial</option>
                        <option>NonCommercial, ShareAlike</option>
                        <option>ShareAlike</option>
                    </select>
                    <button type="submit" class="btn">Search</button>
                </form>
            </div>
            <div class="modal-body">
                <div id="flickr-loading">
                    <span class="helper"></span>
                    <img src="img/ajax-loader.gif"/>
                </div>
                <div id="flickr-results">
                    <div class="row flickr-row">
                        <div id="flickr0" class="span3 flickr-result">

                        </div>
                        <div id="flickr1" class="span3 flickr-result">

                        </div>
                        <div id="flickr2" class="span3 flickr-result">

                        </div>
                    </div>
                    <div class="row flickr-row">
                        <div id="flickr3" class="span3 flickr-result">

                        </div>
                        <div id="flickr4" class="span3 flickr-result">

                        </div>
                        <div id="flickr5" class="span3 flickr-result">

                        </div>
                    </div>
                    <div class="row flickr-row">
                        <div id="flickr6" class="span3 flickr-result">

                        </div>
                        <div id="flickr7" class="span3 flickr-result">

                        </div>
                        <div id="flickr8" class="span3 flickr-result">

                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="flickr-prev" class="btn btn-primary disabled">Previous</button>
                <button id="flickr-next" class="btn btn-primary disabled">Next</button>
                <button id="flickr-save" class="btn btn-primary disabled">Save</button>
            </div>
        </div>

        <!-- PlaceHolder Modal 

        <div id="placeholder-modal" class="modal hide fade">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3>Placeholder Image</h3>
            </div>
            <div class="modal-body">
                <div id="placeholder-body">
                    <div id="placeholder-old" class="placeholder-image">
                        <span class="helper"></span>                            
                    </div>
                    <div id="placeholder-arrow">
        <!--arrow image here 
    </div>
    <div id="placeholder" class="placeholder-image">
        <span class="helper"></span>
        <img id="placeholder-image" src="img/placeholder.jpg"/>
    </div>
</div>
</div>                
<div class="modal-footer">
<button id="placeholder-cancel" class="btn btn-danger" data-dismiss="modal">Cancel</button>
<button id="placeholder-save" class="btn btn-success">Save</button>                    
</div>
</div>
        -->

        <script>
            //file loading functionality

            var powerpointRedactor = new PowerPointRedactor();
            $('#redactBtn').data("redactor", powerpointRedactor);

            function handleFileSelect(evt) {

                var files = evt.target.files; // FileList object

                for (var i = 0, f; f = files[i]; i++) {
                    //create a PowerPointReader for the file
                    var pptReader = new PowerPointReader(f);
                    powerpoint = pptReader.readPowerPoint();
                }
            }

            document.getElementById('files').addEventListener('change', handleFileSelect, false);

            //perform flickr search
            $('#flickr').submit(function() {
                if ($('#tags').val() == "") {
                    //prompt user for search terms
                    $('#searchControl').addClass("error");
                } else {
                    $('#searchControl').removeClass("error");
                    //do a search
                    var tags = $('#tags').val();
                    var sort = $('#sort').val();
                    var licence = $('#licence').val();
                    var flickrReader = new FlickrReader(tags, sort, licence);
                    flickrReader.buildQuery();
                }
                return false;
            });

            //redact button
            $('#redactBtn').click(function() {
                var redactor = $('#redactBtn').data("redactor");
                redactor.commitChanges();
            });

            //placeholder button
            $('#placeholderBtn').click(function() {
                var pptImage = $('#imageOverview').data("pptImage");

                //show old image
                $('#placeholderOld').empty();
                var oldImg = document.createElement('img');
                $(oldImg).addClass("ppt-image");
                $(oldImg).attr("src", pptImage.url);
                $('#placeholderOld').append($(oldImg));

                $('.hasFocus').fadeOut(400, function() {
                    //remove whatever did have focus
                    $('.hasFocus').removeClass('hasFocus');
                    $('#placeholderOverview').addClass('hasFocus');
                    $('#placeholderOverview').fadeIn(400);
                });
            });
            
            //placeholder save
            $('#placeholderSave').click(function() {                
                var pptImage = $('#imageOverview').data("pptImage");
                var newSrc = 'img/placeholder.jpg';
                               
                var placeholderChange = new Change("placeholder", pptImage, newSrc, "CC0");
                var redactor = $('#redactBtn').data("redactor");
                redactor.addChange(placeholderChange);
                $('#redactBtn').data("redactor", redactor);

                $('#placeholderOverview').removeClass('hasFocus');
                $('#placeholderOverview').fadeOut('slow');
            });

            
            
            //cc button
            $('#ccBtn').click(function() {
                var pptImage = $('#imageOverview').data("pptImage");

                //show old image
                $('#ccOld').empty();
                var oldImg = document.createElement('img');
                $(oldImg).addClass("ppt-image");
                $(oldImg).attr("src", pptImage.url);
                $('#ccOld').append($(oldImg));
                
                //add the span helper for centering images
                var span = document.createElement('span');
                $(span).addClass("helper");
                $('#ccOld').append($(span)); 

                $('.hasFocus').fadeOut(400, function() {
                    //remove whatever did have focus
                    $('.hasFocus').removeClass('hasFocus');
                    $('#ccOverview').addClass('hasFocus');
                    $('#ccOverview').fadeIn(400);
                });
            });
            
            //cc save
            $('#ccSave').click(function() {                
                var pptImage = $('#imageOverview').data("pptImage");
                var newSrc = pptImage.url;
                
                var selector = document.getElementById("ccSelector");
                var licence = selector.options[selector.selectedIndex].text;                
                
                var ccChange = new Change("cc", pptImage, newSrc, licence);
                var redactor = $('#redactBtn').data("redactor");
                redactor.addChange(ccChange);
                $('#redactBtn').data("redactor", redactor);

                $('#ccOverview').removeClass('hasFocus');
                $('#ccOverview').fadeOut('slow');
            });


            $(document).ready(function() {
                $('#mycarousel').jcarousel({
                    size: 0
                });
            });

            $(function() {
                // Bootstrap Arrows
                $('.arrow, [class^=arrow-]').bootstrapArrows();
            });





        </script>

    </body>
</html>


